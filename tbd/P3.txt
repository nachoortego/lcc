SELECT * 
FROM J;

SELECT * 
FROM J 
WHERE ciudad = 'Londres';

SELECT DISTINCT S#
FROM SPJ
WHERE J# = 'J1'
ORDER BY S#;

SELECT * 
FROM SPJ 
WHERE cant BETWEEN 300 AND 750;

SELECT DISTINCT COLOR, CIUDAD
FROM P;




SELECT SPJ.S#, SPJ.P#, SPJ.J#
FROM SPJ
JOIN S ON SPJ.S# = S.S#
JOIN P ON SPJ.P# = P.P#
JOIN J ON SPJ.J# = J.J#
WHERE S.CIUDAD = P.CIUDAD 
  AND P.CIUDAD = J.CIUDAD;

SELECT SPJ.S#, SPJ.P#, SPJ.J#
FROM SPJ
JOIN S ON SPJ.S# = S.S#
JOIN P ON SPJ.P# = P.P#
JOIN J ON SPJ.J# = J.J#
WHERE S.CIUDAD <> P.CIUDAD
   OR P.CIUDAD <> J.CIUDAD;

SELECT SPJ.S#, SPJ.P#, SPJ.J#
FROM SPJ
JOIN S ON SPJ.S# = S.S#
JOIN P ON SPJ.P# = P.P#
JOIN J ON SPJ.J# = J.J#
WHERE S.CIUDAD <> P.CIUDAD
  AND P.CIUDAD <> J.CIUDAD
  AND P.CIUDAD <> S.CIUDAD;

SELECT P# 
FROM P
JOIN SPJ ON P.P# = SPJ.P#
JOIN S ON SPJ.S# = S.S#
WHERE S.CIUDAD = 'Londres';

SELECT P# 
FROM P
JOIN SPJ ON P.P# = SPJ.P#
JOIN S ON SPJ.S# = S.S#
JOIN J ON SPJ.J# = J.J#
WHERE S.CIUDAD = 'Londres'
  AND J.CIUDAD = 'Londres';

SELECT DISTINCT S.CIUDAD AS ciudad_proveedor, J.CIUDAD AS ciudad_proyecto
FROM SPJ
JOIN S ON SPJ.S# = S.S#
JOIN J ON SPJ.J# = J.J#;

SELECT DISTINCT P.P#
FROM SPJ
JOIN S ON SPJ.S# = S.S#
JOIN J ON SPJ.J# = J.J#
JOIN P ON SPJ.P# = P.P#
WHERE S.CIUDAD = J.CIUDAD;

SELECT DISTINCT J.J#
FROM SPJ
JOIN S ON SPJ.S# = S.S#
JOIN J ON SPJ.J# = J.J#
WHERE S.CIUDAD <> J.CIUDAD;
 
SELECT DISTINCT A.P# AS parte1, B.P# AS parte2
FROM SPJ A
JOIN SPJ B ON A.S = B.S#
WHERE A.P# < B.P#;


SELECT COUNT(DISTINCT J#)
FROM SPJ
WHERE S# = 'S1';

SELECT SUM(CANT) 
FROM SPJ
WHERE S# = 'S1' AND P# = 'P1';

SELECT P#, J#, SUM(CANT)
FROM SPJ
GROUP BY P#, J#;

SELECT P# 
FROM SPJ
GROUP BY P#
HAVING AVG(CANT) > 320;


SELECT *
FROM SPJ
WHERE CANT IS NOT NULL;


SELECT J#, CIUDAD
FROM J
WHERE SUBSTRING(CIUDAD FROM 2 FOR 1) = 'o';


SELECT JNOMBRE
FROM J
WHERE J# IN (
    SELECT J#
    FROM SPJ
    WHERE S# = 'S1'
);

SELECT COLOR 
FROM P
WHERE P# IN (
    SELECT P# 
    FROM SPJ
    WHERE S# = 'S1'
);

SELECT P# 
FROM SPJ
WHERE J# IN (
    SELECT J#
    FROM J
    WHERE CIUDAD = 'Londres'
);

SELECT J# 
FROM SPJ
WHERE P# IN (
    SELECT P#
    FROM SPJ
    WHERE S# = 'S1'
);

SELECT DISTINCT S# 
FROM SPJ 
WHERE P# IN (
    SELECT DISTICNT P#
    FROM SPJ
    WHERE S# IN (
        SELECT DISTINCT S#
        FROM SPJ
        JOIN P ON SPJ.P# = P.P#
        WHERE P.COLOR = 'Rojo'
    )
);

SELECT S#
FROM S
WHERE SITUACION < (
    SELECT SITUACION
    FROM S
    WHERE S# = 'S1'
);

SELECT J#
FROM J
WHERE CIUDAD = (
    SELECT MIN(CIUDAD)
    FROM J
);




SELECT SPJ.P# 
FROM SPJ
WHERE EXISTS (
    SELECT J#
    FROM J
    WHERE CIUDAD = 'Londres'
      AND J.J# = SPJ.J#
);

SELECT SPJ.J# 
FROM SPJ
WHERE EXISTS (
    SELECT P#
    FROM SPJ AS X
    WHERE S# = 'S1'
      AND SPJ.J# = X.J#
);

SELECT J.J#
FROM SPJ
WHERE NOT EXISTS (
    SELECT S#
    FROM SPJ
    JOIN S ON SPJ.S# = S.S#
    JOIN P ON SPJ.P# = P.P#
    WHERE S.CIUDAD = 'Londres' 
      AND P.COLOR = 'Rojo'
      AND J.J# = SPJ.J#
);

SELECT SPJ.J#
FROM SPJ
WHERE S# = 'S1' 
  AND NOT EXISTS (
    SELECT *
    FROM SPJ AS X
    WHERE X.S# <> 'S1'
      AND SPJ.J# = X.J#
);


SELECT CIUDAD FROM S
UNION 
SELECT CIUDAD FROM P
UNION
SELECT CIUDAD FROM J

UPDATE P
SET COLOR = 'Gris'
WHERE COLOR = 'Rojo'

DELETE FROM J
WHERE J# NOT IN (
    SELECT DISTINCT J#
    FROM SPJ
);


INSERT INTO S
VALUES ('S10', 'Salazar', NULL, 'Nueva York'); 





